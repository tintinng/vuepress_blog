## JavaScript代码执行流程
### 编译阶段
- 输入：一段JavaScript代码
- 输出：执行上下文 + 可执行代码
  - **变量对象** ：上下文中的var变量和函数都存在这个对象上，js无法访问
  - **词法对象**：上下文中的let、const和块级作用域会放在这个对象上
- 变量提升：在创建执行上下文时，把函数声明和var声明的变量放入变量对象中
- let和const声明的变量会放入词法环境对象中
- 函数定义的时候会创建作用域链，装载包含上下文的变量对象
### 执行阶段
- 把当前上下文的变量对象推入作用域链最前端
- 按顺序执行可执行代码

## 执行上下文与调用栈
### 上下文
- 执行全局代码的时候————编译全局代码并创建**全局执行上下文**
  - 全局上下文对应的变量对象就是window
- 调用一个函数的时候————编译函数体内的代码并创建**函数执行上下文**
  - 箭头函数并不会创建自身的执行上下文，使用包含上下文的this
- 使用eval的时候————eval的代码被编译并创建**eval执行上下文**
### 管理执行上下文
  - 创建执行上下文的时候入栈
  - 销毁执行上下文的时候出栈
## 作用域
- **定义变量的区域，决定了变量的生命周期和可访问范围**
- window对象中的变量的作用域就是全局作用域
### 全局作用域
- 伴随页面的生命周期，在代码中任何地方都可以访问
### 函数作用域
- 在函数内部定义的变量，只能在函数内部被访问
### 块级作用域
- let关键字和const关键字支持
- 块级作用域是通过词法环境来实现的
- 在词法环境内部维持了一个小型栈结构，栈底是函数最外层的变量。进入一个作用域块后，就会把该作用域块内部的变量压到栈顶；当作用域执行完成后，该作用域的信息就会从栈顶弹出
## 作用域链
- 上下文中的代码在执行的时候，会创建变量环境对象的一个作用域链，决定了各级上下文中的代码在访问变量和函数时的顺序。
- 作用域链在定义函数的时候就会创建好，在执行的时候会把函数的上下文对应的变量对象放入作用域链的首部
- 理解：一个链表，头节点为当前变量对象，尾节点必为全局变量对象。**作用域链由词法作用域决定，词法作用域由代码结构来确定，不是在调用栈中找**